<!doctype html>
<!--[if lt IE 7]> <html class="no-js ie6 oldie" lang="en"> <![endif]-->
<!--[if IE 7]>    <html class="no-js ie7 oldie" lang="en"> <![endif]-->
<!--[if IE 8]>    <html class="no-js ie8 oldie" lang="en"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"> <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

  <title></title>
  <meta name="description" content="">
  <meta name="author" content="">

  <meta name="viewport" content="width=device-width,initial-scale=1">

  <!-- CSS concatenated and minified via ant build script-->
  <link rel="stylesheet" href="css/style.css">
  <link rel="stylesheet" href="css/solarized_light.css">

  <style type="text/css">
/*    html {background-color: #933; }*/
    header{ position:relative; height: 180px; }
    h1{
      font-family: 'History-One', cursive; 
      font-size:72px; 
      color:#399; 
      font-weight:normal; 
      position:absolute;
      top:0; left:0;
      letter-spacing:.25em;
    }
    h1.one { font-family: 'History-Seventeen'; }
    h1.seventeen{ font-family: 'History-Seventeen'; }
    h1.thirteen { font-family: 'History-Thirteen'; }
    h1.eleven { font-family: 'History-Eleven'; }
    h1.six { font-family: 'History-Six'; }

    .bluegreen { color: #399; }
    .orange { color: orange; }
    .pink { color:pink; }
    .green { color:green; }
    .blue { color:blue; }

    #container{ width:800px; padding:20px; background-color: }
  </style>
  <!-- end CSS-->

  <script src="js/libs/modernizr-2.0.6.min.js"></script>
  <!-- <link href='http://fonts.googleapis.com/css?family=Monoton' rel='stylesheet' type='text/css'> -->
</head>

<body>

  <div id="container">
    <header>
      <h1 data-overlay="feet,blerg">meatglue</h1>
    </header>
    <div id="main" role="main" class="">
      <div class="intro">
        <p>Meatglue is a jQuery+Backbone+jQueryUI library which simplifies the process of creating reactive bindings on your webpages.
        <p>Modeled off Bret Victor's tangle and tanglekit (who, btw, hat tip), meatglue is designed to be used in a similar fashion, but on sites where backbone and jquery ui are already present. Meatglue is not tangle, though.
        <p>A better way of thinking about it is a collection of related views which can be rapidly dropped into a page. The emphasis here is rapid development. I like backbone, but it's a bit time consuming to set up a json object to get a backbone test going.
        <p>This is like diet-backbone, you get some pre-built views and some pre-made bindings. You can specify validation functions (or not) and you can also set up mappings/bindings from variables onto other variables.
      </div>

      <div class="meatglue">
        <div class="demo">
          <script type="text/meatglue">
            defaults = { pinky: "Gee, Brain, what do you want to do tonight?" };
          </script>
        </div>
        <p>The simplest meatglue variable is the VarView, you can specify it by giving a <code>span</code> element <code>data-name</code> attribute. The <code>span</code> will be populated with the corresponding variable set in defaults</p>
        <div class="demo">
          <p>Here is a variable: <span data-name="pinky"></span></p>
        </div>

        <div class="codesnippets"></div>
      </div>

      <div class="meatglue demo">

        <script type="text/meatglue">
          defaults = { freeinput: "type something here" };
          update = function(){
            var fi = this.get("freeinput");
            if (fi !== defaults.freeinput) { this.reveal("milestone"); }
          }
        </script>

        <p>this is a free input: <span data-name="freeinput" data-type="input"></span>. Its value is mirrored here:<span data-name="freeinput"></span>
        <p data-section="milestone">
          congrats, you started playing with the free input!
        </p>
      </div>

      <div class="meatglue">
        <p> In general, the conversion between Celsius and Fahrenheit is governed by <i>F = C * 9/5 + 32</i>. So, for example: <span data-name="CELCIUS"></span>°C = <span data-name="FARENHEIT"></span>°F </p>
        <p>What temperature, in degrees celcius, would we need to get to <span data-name="FEXPECTED"></span>°F? Change this value here: <span data-name="CELCIUS" data-type="editable"></span>°C

        <p>Great! <span data-name="CELCIUS"></span>°C is the right value.</p>
        <p>let's see what happens here:<span data-name="blerg" data-type="slidable"></span> ==> <span data-name="foo"></span>

        <p>Fun with ratios! A : B :: C : D
        <p>Here are some variables to drag around: 
          <span data-name="A" data-type="draggable"></span>
          <span data-name="B" data-type="draggable"></span>
          <span data-name="C" data-type="draggable"></span>
          <span data-name="D" data-type="draggable"></span>
        </p>
        <p>Here are some targets:
          <span data-name="target1" data-type="droppable"></span>:
          <span data-name="target2" data-type="droppable"></span>::
          <span data-name="target3" data-type="droppable"></span>:
          <span data-name="target4" data-type="droppable"></span>

      
      <div data-section="ratio-success">
        <p> Booyeah!
      </div>

	    <script type="text/meatglue">
	        // populate some defaults
	        defaults = {
	          "freeinput" : "hee hee",
	          "CELCIUS" : 23,
	          "FEXPECTED" : 149,
	          "blerg" : 12,
	          "foo" : 14,
	          "A":3,
	          "B":4,
	          "C":12,
	          "D":16
	        }

	        update = function(){
	          var celcius = this.get("CELCIUS");
	          var fExpected = this.get("FEXPECTED");
	          var blerg = this.get("blerg");

	          this.set({"FARENHEIT": (celcius * 9 / 5 ) + 32 });
	          if(this.get("FARENHEIT") == fExpected){
	          }
	          this.set({"foo": blerg * 3});
	          var t1 = this.getget("target1");
	          var t2 = this.getget("target2");
	          var t3 = this.getget("target3");
	          var t4 = this.getget("target4");
	          var a = this.get("A");
	          var b = this.get("B")
	          if(t1/t2 === t3/t4 && t1/t2 === a/b){
	            this.reveal("ratio-success")
                $("[data-section='ratio-success']").html("<p>Ratio Success!</p>")
	          }else{
	          	$("[data-section='ratio-success']").html("<p>Make the ratio work!")
	          }
	        }

	        init = function(){
	          this.update();
	          this.reveal("ratios");
	        }

	    </script>
      </div>

    </div>

    

  </div> <!--! end of #container -->


  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.js"></script>
  <script>window.jQuery || document.write('<script src="js/libs/jquery-1.7.1.js"><\/script>')</script>
  <script src="js/libs/underscore.js"></script>
  <script src="js/libs/backbone.js"></script>
  <script src="js/libs/jquery-ui-1.8.16.custom.min.js"></script>
  <script src="js/libs/jquery.mobile.vmouse.js"></script>

  <script src="http://yandex.st/highlightjs/6.1/highlight.min.js"></script>

  <!-- scripts concatenated and minified via ant build script-->
  <script defer src="js/plugins.js"></script>

  <!-- put your new backbone creation here -->
  <script src="js/meatglue.js"></script>
	<script type="text/javascript" charset="utf-8">  

  // dedent a block of text so that everything starts at least 0 spaces from the
  // start of the line (but retain actual indenting inside the block)
  var dedent = function( somecode ){
    var pieced = somecode.split("\n");
    var testre = /^(\s*)/gm;

    var spacey = /^(\s*)\S*/;
    var defaultindent = _(pieced)
      .map( function(line){ return spacey.exec(line); } )
      .filter(function(match){ return match[0].length !== match[1].length; })
      .map(function(match){ return match[1].length })
    var minIndent = _(defaultindent).min()
    cutitout = new RegExp("^\\s{"+minIndent+"}","gm")
    somecode = $.trim(somecode).replace(cutitout, "")
    return somecode;
  }

  $(document).ready(function(){
	// for each meatglue block, gather the documentation and append it to 
	// the codesnippets div
    $(".meatglue").each(function(i,e){
      var demoblock = $(e);

      // grab code in each block, dedent it, and add to the pre
      demoblock.find(".demo").each(function( idx, elt ){
        var somecode = dedent( $(elt).html() );
        var snippet = $("<pre>").append($("<code>").text( somecode ))
        demoblock.find(".codesnippets").append(snippet)
      })
    })

    // apply syntax highlighting ( will probably switch this later, but i'm a sucker
    // for solarized )
    $(".codesnippets pre code").each(function(i,e){ hljs.highlightBlock(e, '  '); })

    // actually eval meatglue scripts for each given meatglue block
    $.fn.meatglueLoad( $(".meatglue") )

    // prettify the header
    $("h1").each(function(i,e){
      // var otherFonts = $(e).data("overlay").split(",");
      var otherFonts =  _(
		  _.shuffle(["one", "seventeen", "thirteen", "eleven", "six"]))
		.first(3); 
      var colours = _.first(
        _(["bluegreen", "orange", "pink", "green", "blue"]).shuffle(),
        3)
      _(otherFonts).each(function(elt, idx){
        var dup = $(e).clone().addClass( elt+" "+colours[idx] );
        $("header").append(dup)
      });
    })

  })
  </script>
  <!-- end scripts-->

  <!--[if lt IE 7 ]>
    <script src="//ajax.googleapis.com/ajax/libs/chrome-frame/1.0.3/CFInstall.min.js"></script>
    <script>window.attachEvent('onload',function(){CFInstall.check({mode:'overlay'})})</script>
  <![endif]-->

</body>
</html>
